package com.br.project.util;

import java.io.IOException;
import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.commons.lang3.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.web.servlet.error.ErrorAttributes;
import org.springframework.boot.web.servlet.error.ErrorController;
import org.springframework.http.HttpHeaders;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.context.request.ServletWebRequest;

import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;

@Controller
public class CustomErrorController implements ErrorController {

  @Autowired private ErrorAttributes errorAttributes;
  @Autowired private ObjectMapper mapper;

  @RequestMapping("/error")
  @ResponseBody
  public Object handleError(HttpServletRequest request, HttpServletResponse response) {

    ServletWebRequest requestAttributes = new ServletWebRequest(request);

    Map<String, Object> errorAttributes_ = errorAttributes.getErrorAttributes(requestAttributes, true);

    if (isHtmlRequest(request) || (request.getHeader("output") != null && request.getHeader("output").equals("html"))
        || (!isAjax(request) && isHtmlRequest(request) && request.getContentType() == null)) {

      Integer statusCode = (Integer) request.getAttribute("javax.servlet.error.status_code");

      if (statusCode == null) {
        statusCode = -1;
      }

      String titulo = "";
      String msg = "";

      if (statusCode == 400) {
        titulo = "Atenção <span>!!!</span>";
        String messages = "";
        try {

          StringBuilder erroMessage = new StringBuilder();
          if (errorAttributes_.get("messages") != null) {
            erroMessage.append(errorAttributes_.get("messages").toString());
          }
          if (errorAttributes_.get("message") != null) {
            erroMessage.append(errorAttributes_.get("message").toString());
          }

          JsonNode jNode;
          jNode = mapper.readTree(erroMessage.toString());
          for (JsonNode message : jNode) {
            if (message != null && !message.isNull())
              messages += message.textValue() + "\n";
          }
        } catch (IOException e) {
          messages = errorAttributes_.get("message").toString();
        }
        msg = messages;
      } else if (statusCode == 404) {
        titulo = "Página não mapeada<span></span>";
      } else if (statusCode == 500) {
        titulo = "Houve um erro no processamento <span>:(</span>";
      } else if (statusCode == -1) {
        titulo = "Página não pode ser acessada<span></span>";
        statusCode = 200;
      } else {
        titulo = "Opsss... <span>:(</span>";
        msg = statusCode + " - " + errorAttributes_.get("message").toString();
      }

      String contents = getHtmlErrorMsg(titulo, msg);
      HttpHeaders headers = new HttpHeaders();
      headers.setContentType(MediaType.parseMediaType("text/html; charset=utf-8"));
      headers.setCacheControl("must-revalidate, post-check=0, pre-check=0");
      ResponseEntity<Object> response_ = new ResponseEntity<Object>(contents, headers, HttpStatus.valueOf(statusCode));
      return response_;

    } else {
      return new ErrorJson(response.getStatus(), errorAttributes_);
    }

  }

  @Override
  public String getErrorPath() {
    return "/error";
  }

  private String getHtmlErrorMsg(String titulo, String msg) {
    String img = "data:image/png;base64,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";
    return "<!doctype html><html lang='en'><head> <meta charset='utf-8'> <title>Project WS</title> <style>html{padding: 30px 10px; font-size: 20px; line-height: 1.4; color: #737373; background: #f0f0f0; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;}html, input{font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;}body{max-width: 500px; _width: 500px; padding: 30px 20px 50px; border: 1px solid #b3b3b3; border-radius: 4px; margin: 0 auto; box-shadow: 0 1px 10px #a7a7a7, inset 0 1px 0 #fff; background: #fcfcfc;}h1, h3{margin: 0 10px; text-align: center;}h1 span, h3 span{color: #bbb;}p{margin: 1em 0;}ul{padding: 0 0 0 40px; margin: 1em 0;}.container{max-width: 380px; _width: 380px; margin: 0 auto;}#goog-fixurl ul{list-style: none; padding: 0; margin: 0;}#goog-fixurl form{margin: 0;}.img-center{text-align: center;}.img-center img{width: 90px;}</style></head><body><div class='container'> <div class='img-center'> <img src='"
        + img + "'/> </div><h3>" + titulo + "</h3> <p></p><p style='text-align:center'>" + msg + "</p></div></body></html>";
  }

  private boolean isAjax(HttpServletRequest request) {
    String requestedWithHeader = request.getHeader("X-Requested-With");
    return "XMLHttpRequest".equals(requestedWithHeader);
  }

  private boolean isHtmlRequest(HttpServletRequest request) {
    String acceptHeader = request.getHeader("Accept");
    List<MediaType> acceptedMediaTypes = MediaType.parseMediaTypes(acceptHeader);
    return acceptedMediaTypes.contains(MediaType.TEXT_HTML);
  }

  public class ErrorJson {

    public Integer status;
    public String error;
    public String message;
    public String msg;
    public List<String> messages;
    public String timeStamp;
    public String trace;

    @SuppressWarnings("unchecked")
    public ErrorJson(int status, Map<String, Object> errorAttributes) {
      this.status = status;
      this.error = (String) errorAttributes.get("error");
      this.message = (String) errorAttributes.get("message");
      if (errorAttributes.get("messages") != null) {
        try {
          this.messages = (List<String>) errorAttributes.get("messages");
          this.msg = StringUtils.join((List<String>) errorAttributes.get("messages"), "\n");
        } catch (Exception e) {

        }
      }
      this.timeStamp = errorAttributes.get("timestamp").toString();
      this.trace = (String) errorAttributes.get("trace");
    }

  }

}
